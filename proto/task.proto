syntax = "proto3";
package task;
option go_package = "github.com/King-kin5/task/proto/pb";
import "google/protobuf/timestamp.proto";

// TaskService defines all the RPC methods for task management
// This is the gRPC API that clients will call
service TaskService {
    // Command: Create a new task (Write operation)
  rpc CreateTask(CreateTaskRequest) returns (CreateTaskResponse);
  
  // Command: Update task status (Write operation)
  rpc UpdateTaskStatus(UpdateTaskStatusRequest) returns (UpdateTaskStatusResponse);
  
  // Command: Delete a task (Write operation)
  rpc DeleteTask(DeleteTaskRequest) returns (DeleteTaskResponse);
  
  // Query: Get a single task (Read operation)
  rpc GetTask(GetTaskRequest) returns (GetTaskResponse);
  
  // Query: Get all tasks (Read operation)
  rpc GetTasks(GetTasksRequest) returns (GetTasksResponse);
  
  // Query: Get task statistics (Read operation)
  rpc GetStatistics(GetStatisticsRequest) returns (GetStatisticsResponse);
}

// Task status enum
// Defines all possible states a task can be in

enum TaskStatus{
    PENDING = 0;      // Task is waiting to be started
  IN_PROGRESS = 1;  // Task is currently being worked on
  COMPLETED = 2;    // Task is finished
  CANCELLED = 3;    // Task was cancelled
}
// Task message represents a task entity
message Task {
  string id = 1;              // Unique identifier (UUID)
  string title = 2;           // Task title
  string description = 3;     // Task description
  TaskStatus status = 4;      // Current status
  google.protobuf.Timestamp created_at = 5;      // ISO 8601 timestamp
  google.protobuf.Timestamp updated_at = 6;      // ISO 8601 timestamp
}
// CreateTaskRequest - Request to create a new task
message CreateTaskRequest {
  string title = 1;           // Required: Task title
  string description = 2;     // Optional: Task description
}
// CreateTaskResponse - Response after creating a task
message CreateTaskResponse {
  Task task = 1;              // The newly created task
  string message = 2;         // Success message
}
// UpdateTaskStatusRequest - Request to update task status
message UpdateTaskStatusRequest {
  string id = 1;              // Required: Task ID to update
  TaskStatus status = 2;      // Required: New status
}

// UpdateTaskStatusResponse - Response after updating status
message UpdateTaskStatusResponse {
  Task task = 1;              // The updated task
  string message = 2;         // Success message
}

// DeleteTaskRequest - Request to delete a task
message DeleteTaskRequest {
  string id = 1;              // Required: Task ID to delete
}

// DeleteTaskResponse - Response after deleting a task
message DeleteTaskResponse {
  bool success = 1;           // Whether the deletion was successful
  string message = 2;         // Success or error message
}

// GetTaskRequest - Request to retrieve a single task
message GetTaskRequest {
  string id = 1;              // Required: Task ID to retrieve
}

// GetTaskResponse - Response with a single task
message GetTaskResponse {
  Task task = 1;              // The retrieved task
}

// GetTasksRequest - Request to retrieve tasks
message GetTasksRequest {
  int32 page = 1;
  int32 page_size = 2;
  TaskStatus status = 3;
}

// GetTasksResponse - Response with list of tasks
message GetTasksResponse {
  repeated Task tasks = 1;    // List of all tasks
  int32 total = 2;            // Total count
  int32 page = 3;
  int32 page_size = 4;
}

// GetStatisticsRequest - Request for task statistics
// Empty for now
message GetStatisticsRequest {}

// Statistics message
message Statistics {
    int32 total_tasks = 1;
    int32 pending_tasks = 2;
    int32 in_progress_tasks = 3;
    int32 completed_tasks = 4;
    int32 cancelled_tasks = 5;
    google.protobuf.Timestamp last_updated = 6;
}

// GetStatisticsResponse - Response with statistics
message GetStatisticsResponse {
    Statistics statistics = 1;
}